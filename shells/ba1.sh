#!/usr/bin/env bash
# ===============================================
# Moreanp å½©è‰²ç™»å½• Banner ä¸€é”®å®‰è£…è„šæœ¬
# ===============================================

BANNER_PATH="/usr/local/bin/moreanp_banner.sh"

cat > "$BANNER_PATH" <<'EOF'
#!/usr/bin/env bash
clear

# ---------------- å½©è‰²è‰ºæœ¯å­— ----------------
echo -e "[0;1;31;91mâ–„[0m    [0;1;36;96mâ–„[0m                                          "
echo -e "[0;1;33;93mâ–ˆ[0;1;32;92mâ–ˆ[0m  [0;1;36;96mâ–ˆ[0;1;34;94mâ–ˆ[0m  [0;1;35;95mâ–„[0;1;31;91mâ–„â–„[0m    [0;1;36;96mâ–„[0m [0;1;34;94mâ–„â–„[0m   [0;1;31;91mâ–„[0;1;33;93mâ–„â–„[0m    [0;1;34;94mâ–„â–„[0;1;35;95mâ–„[0m   [0;1;33;93mâ–„[0m [0;1;32;92mâ–„â–„[0m   [0;1;34;94mâ–„[0;1;35;95mâ–„â–„[0;1;31;91mâ–„[0m  "
echo -e "[0;1;32;92mâ–ˆ[0m [0;1;36;96mâ–ˆ[0;1;34;94mâ–ˆ[0m [0;1;35;95mâ–ˆ[0m [0;1;31;91mâ–ˆâ–€[0m [0;1;33;93mâ–€[0;1;32;92mâ–ˆ[0m   [0;1;34;94mâ–ˆâ–€[0m  [0;1;31;91mâ–€[0m [0;1;33;93mâ–ˆâ–€[0m  [0;1;36;96mâ–ˆ[0m  [0;1;34;94mâ–€[0m   [0;1;31;91mâ–ˆ[0m  [0;1;32;92mâ–ˆâ–€[0m  [0;1;34;94mâ–ˆ[0m  [0;1;35;95mâ–ˆ[0;1;31;91mâ–€[0m [0;1;33;93mâ–€â–ˆ[0m "
echo -e "[0;1;36;96mâ–ˆ[0m [0;1;34;94mâ–€[0;1;35;95mâ–€[0m [0;1;31;91mâ–ˆ[0m [0;1;33;93mâ–ˆ[0m   [0;1;36;96mâ–ˆ[0m   [0;1;35;95mâ–ˆ[0m     [0;1;32;92mâ–ˆâ–€[0;1;36;96mâ–€â–€[0;1;34;94mâ–€[0m  [0;1;35;95mâ–„[0;1;31;91mâ–€â–€[0;1;33;93mâ–€â–ˆ[0m  [0;1;36;96mâ–ˆ[0m   [0;1;35;95mâ–ˆ[0m  [0;1;31;91mâ–ˆ[0m   [0;1;32;92mâ–ˆ[0m "
echo -e "[0;1;34;94mâ–ˆ[0m    [0;1;33;93mâ–ˆ[0m [0;1;32;92mâ–€â–ˆ[0;1;36;96mâ–„â–ˆ[0;1;34;94mâ–€[0m   [0;1;31;91mâ–ˆ[0m     [0;1;36;96mâ–€â–ˆ[0;1;34;94mâ–„â–„[0;1;35;95mâ–€[0m  [0;1;31;91mâ–€[0;1;33;93mâ–„â–„[0;1;32;92mâ–€â–ˆ[0m  [0;1;34;94mâ–ˆ[0m   [0;1;31;91mâ–ˆ[0m  [0;1;33;93mâ–ˆ[0;1;32;92mâ–ˆâ–„[0;1;36;96mâ–ˆâ–€[0m "
echo -e "                                           [0;1;32;92mâ–ˆ[0m     "
echo -e "                                           [0;1;36;96mâ–€[0m     "
echo
echo -e "                                  Powered by Moreanp     "
echo -e " -------------------------------------------------------"

# ---------------- ç³»ç»Ÿä¿¡æ¯ ----------------
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2+$4+$6+$10+$12+$14+$16}')
CPU_DISPLAY="$CPU_USAGE%"
MEM_USED=$(free -b | awk '/Mem:/ {printf "%.1f", $3/1024/1024/1024}')
MEM_TOTAL=$(free -b | awk '/Mem:/ {printf "%.1f", $2/1024/1024/1024}')
DISK_USED=$(df --block-size=1 / | awk 'NR==2{printf "%.1f", $3/1024/1024/1024}')
DISK_TOTAL=$(df --block-size=1 / | awk 'NR==2{printf "%.1f", $2/1024/1024/1024}')
EXT_IP=$(curl -s --max-time 2 https://api.ipify.org || echo "N/A")

printf " CPU:%-5s | MEM:%-7s | DISK:%-7s | IP:%s\n" "$CPU_DISPLAY" "${MEM_USED}/${MEM_TOTAL}" "${DISK_USED}/${DISK_TOTAL}" "$EXT_IP"
echo -e " -------------------------------------------------------"
EOF

chmod +x "$BANNER_PATH"

# æ³¨å†Œç™»å½•è‡ªåŠ¨æ‰§è¡Œ
if ! grep -q "moreanp_banner.sh" ~/.bashrc; then
    echo -e "\n# >>> Moreanp Banner <<<" >> ~/.bashrc
    echo "bash $BANNER_PATH" >> ~/.bashrc
    echo "# >>> End <<<" >> ~/.bashrc
fi

echo -e "\033[1;36mâ†’ å®‰è£…å®Œæˆï¼ä¸‹æ¬¡ç™»å½•æ˜¾ç¤ºå½©è‰² Banner\033[0m"
